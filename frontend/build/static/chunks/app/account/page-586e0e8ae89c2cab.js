(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[346],{9033:function(e,t,s){Promise.resolve().then(s.bind(s,5276))},7160:function(e,t,s){"use strict";var o=s(7437),r=s(9306),a=s(7907),n=s(2265);t.Z=function(e){return t=>{let{isLoggedIn:s}=(0,r.useAuth)(),l=(0,a.useRouter)();return((0,n.useEffect)(()=>{s||l.push("/login")},[s,l]),s)?(0,o.jsx)(e,{...t}):null}}},5276:function(e,t,s){"use strict";s.r(t);var o=s(7437),r=s(2265),a=s(2670),n=s(5070),l=s(1537),d=s(376),i=s(6123);let c=(0,s(7160).Z)(()=>{var e,t,s,c,u,p,m;let{register:h,handleSubmit:f,watch:v,reset:w,setError:x,formState:{errors:E}}=(0,a.cI)(),g=e=>{let t={old_password:e.password,new_password:e.newPassword};n.z.post(l.Z.API_URLS.USER_MANAGEMENT.UPDATE_USER_PASSWORD,t).then(()=>{i.toast.success("Password successfully updated !"),w()},e=>{var t,s,o,r,a;(null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.status)==d.WE.BadRequest&&(null===(o=e.response)||void 0===o?void 0:null===(s=o.data)||void 0===s?void 0:s.old_password)&&x("root.serverError",{type:"400",message:null===(a=e.response)||void 0===a?void 0:null===(r=a.data)||void 0===r?void 0:r.old_password[0]}),i.toast.error("Password could not be updated !")})},[b,N]=(0,r.useState)();return(0,r.useEffect)(()=>{n.z.get(l.Z.API_URLS.USER_MANAGEMENT.CURRENT_USER).then(e=>{e.status==d.WE.Ok&&N(e.data)},e=>{console.log(e)})},[]),(0,o.jsx)("div",{className:"flex justify-center items-center w-full",children:(0,o.jsxs)("div",{className:"px-4 pt-6 pb-8 mb-4 w-full max-w-lg",children:[(0,o.jsx)("h2",{className:"text-3xl font-bold mb-6 text-center ",children:(0,o.jsx)("span",{className:"text-blue-500 bg-clip-text",children:"Account Setting"})}),(0,o.jsxs)("form",{onSubmit:e=>{e.preventDefault(),f(g)(e)},noValidate:!0,children:[(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("label",{htmlFor:"username",className:"block text-gray-700 text-sm font-bold mb-2",children:"Username"}),(0,o.jsx)("div",{children:(0,o.jsx)("input",{defaultValue:(null==b?void 0:b.username)||"",id:"username",type:"text",className:"shadow appearance-none border rounded w-full py-3 px-4 text-gray-400 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Enter username",disabled:!0})})]}),(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("label",{htmlFor:"email",className:"block text-gray-700 text-sm font-bold mb-2",children:"Email"}),(0,o.jsx)("div",{children:(0,o.jsx)("input",{defaultValue:(null==b?void 0:b.email)||"",id:"email",type:"email",className:"shadow appearance-none border rounded w-full py-3 px-4 text-gray-400 leading-tight focus:outline-none focus:shadow-outline",disabled:!0,placeholder:"Enter email"})})]}),(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("label",{htmlFor:"password",className:"block text-gray-700 text-sm font-bold mb-2",children:"Password"}),(0,o.jsx)("div",{children:(0,o.jsx)("input",{id:"password",type:"password",...h("password",{required:!0}),className:"shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Enter password"})}),(null===(e=E.password)||void 0===e?void 0:e.type)==="required"&&(0,o.jsx)("p",{role:"alert",className:"text-red-600 font-semibold mt-2",children:"Password is required"})]}),(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("label",{htmlFor:"new_password",className:"block text-gray-700 text-sm font-bold mb-2",children:"New Password"}),(0,o.jsx)("div",{children:(0,o.jsx)("input",{id:"new_password",type:"password",...h("newPassword",{required:!0}),className:"shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Enter password"})}),(null===(t=E.password)||void 0===t?void 0:t.type)==="required"&&(0,o.jsx)("p",{role:"alert",className:"text-red-600 font-semibold mt-2",children:"New Password is required"})]}),(0,o.jsxs)("div",{className:"mb-6",children:[(0,o.jsx)("label",{htmlFor:"confirm_password",className:"block text-gray-700 text-sm font-bold mb-2",children:"Confirm Password"}),(0,o.jsx)("div",{children:(0,o.jsx)("input",{id:"confirm_password",type:"password",...h("newConfirmPassword",{required:!0,validate:e=>e===v("newPassword")||"Passwords do not match"}),className:"shadow appearance-none border rounded w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",placeholder:"Confirm password"})}),(null===(s=E.newConfirmPassword)||void 0===s?void 0:s.type)==="required"&&(0,o.jsx)("p",{role:"alert",className:"text-red-600 font-semibold mt-2",children:"New Confirm Password is required"}),(null===(c=E.newConfirmPassword)||void 0===c?void 0:c.message)&&(0,o.jsx)("p",{role:"alert",className:"text-red-600 font-semibold mt-2",children:"New Passwords do not match"})]}),(null==E?void 0:null===(u=E.root)||void 0===u?void 0:u.serverError)&&(0,o.jsx)("div",{className:"flex",children:(0,o.jsx)("p",{role:"alert",className:"text-red-600 font-semibold mt-2",children:null==E?void 0:null===(m=E.root)||void 0===m?void 0:null===(p=m.serverError)||void 0===p?void 0:p.message})}),(0,o.jsx)("div",{className:"flex items-center justify-center mt-8",children:(0,o.jsx)("button",{type:"submit",className:"bg-gradient-to-r bg-blue-500 hover:bg-blue-800 text-white font-bold py-3 px-4 rounded focus:outline-none focus:shadow-outline w-full",children:"Update Password"})})]})]})})});t.default=c},1537:function(e,t){"use strict";t.Z={API_HOST:"http://127.0.0.1:8000/",LOCAL_STORAGE:{TOKEN:"token",USER_NAME:"username",CART:{PRODUCTS:"products"}},API_URLS:{POPULATE_DB:"api/v1/initialization/",AUTH:{LOGIN:"api/v1/core/token/",REGISTER:"api/v1/user-management/register/"},PRODUCT:{PRODUCTS:(e,t)=>"api/v1/public/products?page=".concat(e).concat(t?"&search=".concat(t):""),GET_PRODUCT:e=>"api/v1/inventory/products/".concat(e,"/"),ADD_PRODUCT:"api/v1/inventory/products/",UPDATE_PRODUCT:e=>"api/v1/inventory/products/".concat(e,"/")},INVENTORY:{PRODUCTS:(e,t,s)=>"api/v1/inventory/products/?page=".concat(e,"&type=").concat(t).concat(s?"&search=".concat(s):"")},USER_MANAGEMENT:{CURRENT_USER:"api/v1/user-management/current-user/",UPDATE_USER_PASSWORD:"api/v1/user-management/change-password/"},PAY:"api/v1/pay/"},PAGINATION:{PAGE_SIZE:10}}},9306:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthenticationProvider:function(){return l},useAuth:function(){return d}});var o=s(7437),r=s(2265),a=s(1537);let n=(0,r.createContext)({}),l=e=>{let{children:t}=e,[s,l]=(0,r.useState)(!0),[d,i]=(0,r.useState)(null),c=()=>{localStorage.clear(),i(null)};return(0,r.useEffect)(()=>{i(localStorage.getItem(a.Z.LOCAL_STORAGE.TOKEN)&&localStorage.getItem(a.Z.LOCAL_STORAGE.USER_NAME)?{token:localStorage.getItem(a.Z.LOCAL_STORAGE.TOKEN),username:localStorage.getItem(a.Z.LOCAL_STORAGE.USER_NAME)}:null),l(!1)},[l]),(0,r.useEffect)(()=>{let e=e=>{e.key===a.Z.LOCAL_STORAGE.TOKEN&&!e.newValue&&d&&c()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}},[d]),(0,o.jsx)(o.Fragment,{children:s?(0,o.jsx)(o.Fragment,{children:" "}):(0,o.jsx)(n.Provider,{value:{user:d,setUserLoggedIn:e=>{(null==e?void 0:e.token)&&localStorage.setItem(a.Z.LOCAL_STORAGE.TOKEN,null==e?void 0:e.token),(null==e?void 0:e.username)&&localStorage.setItem(a.Z.LOCAL_STORAGE.USER_NAME,null==e?void 0:e.username),i(e)},isLoggedIn:!!d,logoutUser:c},children:t})})},d=()=>(0,r.useContext)(n)},5070:function(e,t,s){"use strict";s.d(t,{z:function(){return n}});var o=s(1537),r=s(3107);let a=r.default.create({baseURL:o.Z.API_HOST,timeout:4e4,headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"}}),n=r.default.create({baseURL:o.Z.API_HOST,timeout:4e4,headers:{Accept:"application/json","Content-Type":"application/json; charset=utf-8"}});n.interceptors.request.use(e=>{let t=localStorage.getItem(o.Z.LOCAL_STORAGE.TOKEN);return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),n.interceptors.response.use(e=>e,e=>(e.response&&401===e.response.status&&(localStorage.clear(),window.location.href="/login"),Promise.reject(e))),t.Z=a},376:function(e,t,s){"use strict";s.d(t,{WE:function(){return f}});let{Axios:o,AxiosError:r,CanceledError:a,isCancel:n,CancelToken:l,VERSION:d,all:i,Cancel:c,isAxiosError:u,spread:p,toFormData:m,AxiosHeaders:h,HttpStatusCode:f,formToJSON:v,getAdapter:w,mergeConfig:x}=s(3107).default}},function(e){e.O(0,[107,123,884,971,69,744],function(){return e(e.s=9033)}),_N_E=e.O()}]);